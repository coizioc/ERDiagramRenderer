<html>
    <head>
        <style>
            #left, #right {
                margin: 2.5%;
                float: left;
                width: 45%;
            }
            textarea {
                width: 100%;
            }
            #input {
                height: 20em;
            }
            #output {
                height: 20em;
            }
        </style>
    </head>
    <body>
        <div id="left">
            <textarea id="input"></textarea><br><br>
            <button id="submit" onclick="convert()">Convert</button><br><br>
            <textarea id="output"></textarea>
        </div>
        <div id="right">
            <h1>ER Diagram Maker</h1>
            <hr>
            <h2>Syntax</h2>
            <ul>
                <li>Empty lines are ignored, except for the first.</li>
                <li>Entity list starts with <code>ENTITIES:</code>.</li>
                <li>Each entity is represented as follows: <code>entity_name(__primary_key__,attribute,...) ISA entity_name</code></li>
                <li><code>ISA entity_name</code> is optional for each entity.</li>
                <li>Entities are listed until the <code>RELATIONSHIPS:</code> keyword is found.</li>
                <li>Relationship list starts with <code>RELATIONSHIPS:</code>.</li>
                <li>Each relationship is represented as follows: <code>entity,entity,...,relationship_name[attribute,...]</code></li>
                <li><code>[attribute,...]</code> is optional for each relationship.</li>
            </ul>
            <h2>Output Instructions</h2>
            <ul>
                <li>Output is <a href="https://mermaidjs.github.io" target="_blank">Mermaid</a> source code. User their online editor <a href="https://mermaidjs.github.io/mermaid-live-editor" target="_blank">here</a>.</li>
                <li>You may need to change the first line to get it to render better. Try <code>graph TD</code> instead of <code>graph LR</code>.</li>
                <li>If the HTML in the entities doesn't render correctly in the online editor, change the configuration to <code>{ "theme": "default", "securityLevel": "loose" }</code>.</li>
                <li>This does not currently support cardinality and participation constraints. </li>
            </ul>
        </div>
        
        <script
			  src="https://code.jquery.com/jquery-3.4.1.min.js"
			  integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
			  crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/8.3.1/mermaid.min.js"></script>
        <script src="js/types.js"></script>
        <script src="js/lexer.js"></script>
        <script src="js/parser.js"></script>
        <script>
            $(document).ready(() => {
                let source = `ENTITIES:
author(__name__,address,URL)
publisher(__name__,address,URL)
book(__ISBN__,title,year,price)
shopping_basket(basket_id)
customer(__email__,name,address,phone)
warehouse(__code__,address,phone)
video(__EIDR__,title,year)
downloadable_video(price) ISA video
bluray(price) ISA video

RELATIONSHIPS:
author,book,written_by
publisher,book,published_by
book,shopping_basket,contains[number_in_basket]
shopping_basket,customer,basket_of
book,warehouse,stocks[number_in_stock]`;

                $('#input').val(source);
            });

            function convert() {
                let input = $('#input').val();

                var graphDefinition = Parser.toMermaid(input);

                $('#output').val(graphDefinition);

            }
        </script>
        </body>
</html>
